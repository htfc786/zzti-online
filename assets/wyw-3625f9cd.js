import{c as L}from"./index-b70d4d65.js";import{_ as O}from"./index-46711d87.js";function R(n){const t=/\n[a-zA-Z]/g.exec(n);if(!t)return{article:n,comments:[]};const e=n.split(t[0]),o=e[0].split(`
`).join(""),r=e.slice(1).join(t[0]),a=(t+r).split(`
`);a.shift();for(let s=0;s<a.length;s++)/^[a-zA-Z@#\d]/.test(a[s])||(a[s-1]+=a[s],a.splice(s,1),s--);return{article:o,comments:a}}function P(n){const[t,e]=n.split("﹝");if(!e){const[r,a]=n.split(" ");return{flag:r,word:"",content:a,special:!0}}const[c,o]=e.split("〕");return{flag:t,word:c,content:o,special:!1}}function B(n,t,e="forward"){const c=["。","，","！","？","；","：","…","—","～","”","“","’","‘","【","】","《","》"];if(e==="forward"){for(let o=t;o<n.length;o++)if(c.includes(n[o]))return o}if(e==="backward"){for(let o=t;o>=0;o--)if(c.includes(n[o]))return o}return-1}function U(n,t,e,c=0){const o=n.indexOf(t,c);if(o===-1)return null;let r=o,a=B(n,o,"forward");a===-1&&(a=n.length-1);let s="";for(;s.length<4||s.length<e.length||!s.includes(e[0]);)r=B(n,r,"backward")+1,r===-1&&(r=0),s=n.slice(r,a),s=s.replace(t,"").replace(" ",""),r-=2;return s=s.replace(/[a-zA-Z]/g,"").replace(" ",""),{sentence:s,start:r,end:a,flagIndex:o}}function N(n,t){const e=t.split(/……|…|\.|\.\.\./g),c=[];for(const o of e){const r=n.indexOf(o);if(r===-1)continue;const a=r+o.length,s={start:r,end:a};c.push(s)}return c}function b(n,t){if(t.length!==1)return{is:!1};if(n.includes("同“")){const e=n.match(/同“(.*?)”/);if(e)return{is:!0,origin:e[1]}}return{is:!1}}function A(n,t,e){const c=n.split("。");if(c[c.length-1]===""&&c.pop(),c.length===1)return[{word:t,sentence:e,content:c[0]+"。",position:N(e,t),tongjia:b(c[0],t)}];const o=[];for(const a of c)if(a.includes("，")){const s=a.split("，");if(!t.includes(s[0])||!e.includes(s[0]))continue;const u=s[0],f=s.slice(1).join("，")+"。";o.push({word:u,sentence:e,content:f,position:N(e,u),tongjia:b(f,u)}),c[c.indexOf(a)]=null}const r=c.filter(a=>a!==null).join("。")+"。";return o.push({word:t,sentence:e,content:r,position:N(e,t),tongjia:b(n,t)}),o}function F(n){const{article:t,comments:e}=R(n),c=new Map,o=[];for(let r of e){const{flag:a,word:s,content:u,special:f}=P(r);c.has(a)||c.set(a,0);const x=c.get(a);if(f)continue;const v=U(t,a,s,x);if(!v)continue;const{sentence:C,flagIndex:k}=v;c.set(a,(k||0)+1);const w=A(u,s,C);o.push(...w)}return o}function M(n){return n.map(t=>{for(const e of t.position)t.sentence=t.sentence.slice(0,e.start)+"<"+t.sentence.slice(e.start,e.end)+">"+t.sentence.slice(e.end);return{q:t.sentence,ans:t.content}})}const g=n=>(Vue.pushScopeId("data-v-ec6b4087"),n=n(),Vue.popScopeId(),n),$={id:"wordTool"},z=g(()=>Vue.createElementVNode("p",null,"支持统编版高中语文书电子版课下注释解析",-1)),q=g(()=>Vue.createElementVNode("p",null,[Vue.createTextVNode("可前往"),Vue.createElementVNode("a",{href:"https://basic.smartedu.cn/tchMaterial?defaultTag=e7bbcefe-0590-11ed-9c79-92fc3b3249d5%2F6a749654-0772-11ed-ac74-092ab92074e6%2F44bee8bc-54e6-11ed-9c34-850ba61fa9f4",target:"_blank"},"智慧中小学网站"),Vue.createTextVNode("复制文言文原文和注释")],-1)),J=g(()=>Vue.createElementVNode("p",{style:{"margin-top":"8px"}},"提示: 导出后请自行上传",-1)),Z={key:0,class:"editable-row-operations"},Q={key:0},W=g(()=>Vue.createElementVNode("a",null,"取消",-1)),H={key:1},G=["onClick"],K=g(()=>Vue.createElementVNode("a",{style:{color:"red"}},"删除",-1)),X={key:2},Y=Vue.defineComponent({__name:"wyw",setup(n){const t=Vue.ref(""),e=Vue.ref([]),c=()=>{if(!t.value){antd.message.error("请输入文言文");return}debugger;const l=F(t.value),p=M(l);if(!p.length){antd.message.error("解析失败");return}p.forEach(V=>{e.value.push(V)}),antd.message.success("解析成功")},o=()=>{if(!e.value.length){antd.message.error("请先解析！");return}const l=e.value,p=JSON.stringify(l),V=new Blob([p],{type:"application/json"}),y=URL.createObjectURL(V),d=document.createElement("a");d.href=y,d.download="wywList.json";const _=antd.Modal.success({title:"导出成功",content:"点击下载按钮下载json",footer:()=>Vue.h("div",{style:"display: flex; flex-direction: row-reverse;"},[Vue.h(antd.Button,{type:"primary",onClick:()=>{d.click(),URL.revokeObjectURL(y),_.destroy()}},{default:()=>"下载"}),Vue.h(antd.Button,{style:"margin-right: 8px;",onClick:()=>{_.destroy()}},{default:()=>"取消"})])})},r=()=>{if(!e.value.length){antd.message.error("请解析文言文");return}antd.Modal.confirm({title:"请输入题库名称",content:Vue.h("input",{id:"tempDataName",placeholder:"请输入题库名称",style:"width: 100%;"}),onOk(){const l=document.getElementById("tempDataName");if(!l.value){antd.message.error("请输入题库名称");return}L(l.value,e.value),antd.message.success("添加成功")}})},a=[{title:"#",dataIndex:"index",width:"10%"},{title:"虚词",dataIndex:"q"},{title:"注释",dataIndex:"ans"},{title:"",dataIndex:"operation"}],s=Vue.ref(),u=Vue.reactive({}),f=l=>JSON.parse(JSON.stringify(l)),x=l=>{u[l]=f(e.value[l])},v=l=>{Object.assign(e.value[l],u[l]),delete u[l]},C=l=>{delete u[l]},k=l=>{e.value.splice(l,1),delete u[l]},w=()=>{e.value.push({word:"",chinese:"",pronounce:""}),x(e.value.length-1);const l=s.value.$el;requestAnimationFrame(()=>{l.scrollTo(0,l.scrollHeight)})};return(l,p)=>{const V=Vue.resolveComponent("a-typography-title"),y=Vue.resolveComponent("a-textarea"),d=Vue.resolveComponent("a-button"),_=Vue.resolveComponent("a-col"),E=Vue.resolveComponent("a-typography-link"),T=Vue.resolveComponent("a-popconfirm"),j=Vue.resolveComponent("a-input"),I=Vue.resolveComponent("a-table"),S=Vue.resolveComponent("a-row");return Vue.openBlock(),Vue.createElementBlock("div",$,[Vue.createVNode(S,{type:"flex",class:"start"},{default:Vue.withCtx(()=>[Vue.createVNode(_,{class:"left",flex:"auto"},{default:Vue.withCtx(()=>[Vue.createVNode(V,{level:2},{default:Vue.withCtx(()=>[Vue.createTextVNode("文言实词解析工具")]),_:1}),Vue.createVNode(V,{level:4},{default:Vue.withCtx(()=>[Vue.createTextVNode("说明")]),_:1}),z,q,Vue.createVNode(y,{value:t.value,"onUpdate:value":p[0]||(p[0]=m=>t.value=m),placeholder:"请文言文原文和注释","auto-size":{minRows:5,maxRows:5},style:{width:"100%"}},null,8,["value"]),Vue.createVNode(d,{type:"primary",onClick:c},{default:Vue.withCtx(()=>[Vue.createTextVNode("解析")]),_:1}),Vue.createVNode(d,{onClick:w},{default:Vue.withCtx(()=>[Vue.createTextVNode("添加")]),_:1}),Vue.createVNode(d,{type:"primary",onClick:o},{default:Vue.withCtx(()=>[Vue.createTextVNode("导出json")]),_:1}),Vue.createVNode(d,{onClick:r},{default:Vue.withCtx(()=>[Vue.createTextVNode("添加至临时数据")]),_:1}),J]),_:1}),Vue.createVNode(_,{class:"right",flex:"auto"},{default:Vue.withCtx(()=>[Vue.createVNode(I,{class:"table",columns:a,"data-source":e.value,bordered:"",pagination:!1,ref_key:"tableRef",ref:s},{bodyCell:Vue.withCtx(({column:m,text:D,index:i})=>[m.dataIndex==="operation"?(Vue.openBlock(),Vue.createElementBlock("div",Z,[u[i]?(Vue.openBlock(),Vue.createElementBlock("span",Q,[Vue.createVNode(E,{onClick:h=>v(i),style:{"margin-right":"2px"}},{default:Vue.withCtx(()=>[Vue.createTextVNode("保存")]),_:2},1032,["onClick"]),Vue.createVNode(T,{title:"放弃更改?",onConfirm:h=>C(i)},{default:Vue.withCtx(()=>[W]),_:2},1032,["onConfirm"])])):(Vue.openBlock(),Vue.createElementBlock("span",H,[Vue.createElementVNode("a",{onClick:h=>x(i),style:{"margin-right":"2px"}},"编辑",8,G),Vue.createVNode(T,{title:"确定删除?",onConfirm:h=>k(i)},{default:Vue.withCtx(()=>[K]),_:2},1032,["onConfirm"])]))])):m.dataIndex==="index"?(Vue.openBlock(),Vue.createElementBlock(Vue.Fragment,{key:1},[Vue.createTextVNode(Vue.toDisplayString(i+1),1)],64)):(Vue.openBlock(),Vue.createElementBlock("div",X,[u[i]?(Vue.openBlock(),Vue.createBlock(j,{key:0,value:u[i][m.dataIndex],"onUpdate:value":h=>u[i][m.dataIndex]=h,style:{margin:"-5px 0"}},null,8,["value","onUpdate:value"])):(Vue.openBlock(),Vue.createElementBlock(Vue.Fragment,{key:1},[Vue.createTextVNode(Vue.toDisplayString(D),1)],64))]))]),_:1},8,["data-source"])]),_:1})]),_:1})])}}});const ne=O(Y,[["__scopeId","data-v-ec6b4087"]]);export{ne as default};
